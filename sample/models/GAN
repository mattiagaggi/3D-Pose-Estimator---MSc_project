


import torch.nn
import numpy as np
from sample.base.base_model import BaseModel
from utils.smpl_torch.pytorch.smpl_layer import SMPL_Layer
from utils.trans_numpy_torch import numpy_to_tensor_float


class Discriminator(BaseModel):
    def __init__(self):
        super().__init__()
        hidden=2
        d_hidden =  500
        self.SMPL_pose=72
        self.SMPL_shape = 10
        module_list = [torch.nn.Linear(self.SMPL_pose+self.SMPL_shape, d_hidden),
                       torch.nn.ReLU(),
                       torch.nn.BatchNorm1d(d_hidden, affine=True)]
        for i in range(hidden-1):
            module_list+=[torch.nn.Linear(d_hidden, d_hidden),
                       torch.nn.ReLU(),
                       torch.nn.BatchNorm1d(d_hidden, affine=True)]
        module_list += [torch.nn.Linear(d_hidden, 1)]
        self.to_label = torch.nn.Sequential(*module_list)

    def forward(self, x):

        out = self.to_label(x)
        return out


class Generator(BaseModel):
    def __init__(self):
        super().__init__()
        hidden=2
        d_hidden =  500
        self.start_dim =20
        self.SMPL_pose=72
        module_list = [torch.nn.Linear(self.start_dim, d_hidden),
                       torch.nn.ReLU(),
                       torch.nn.BatchNorm1d(d_hidden, affine=True)]
        for i in range(hidden-1):
            module_list+=[torch.nn.Linear(d_hidden, d_hidden),
                       torch.nn.ReLU(),
                       torch.nn.BatchNorm1d(d_hidden, affine=True)]
        module_list += [torch.nn.Linear(d_hidden, self.SMPL_pose+self.SMPL_shape)]
        self.to_SMPL = torch.nn.Sequential(*module_list)

    def forward(self, x):

        out = self.to_SMPL(x)
        return out


class GAN_SMPL(BaseModel):
    def __init__(self):
        super().__init__()
        self.generator=Generator()
        self.discriminator = Discriminator


